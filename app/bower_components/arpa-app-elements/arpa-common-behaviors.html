<link rel="import" href="../polymer/polymer.html">

<script>
    (function () {
        'use strict';
        /**
         * @polymerBehavior Polymer.ArpaMessages
         */
        Polymer.ArpaMessages = {
            properties: {
                es: {
                    type: Object,
                    value: {
                        label: {
                            edit: "Editar",
                            save: "Guardar",
                            delete: "Eliminar",
                            cancel: "Cancel",
                            note_title: "Titulo",
                            note_body: "Contenido"
                        },
                        message: {
                            note_list_title: "Notes",
                            note_add_title: "Add New Note",
                            note_edit_title: "Edit Note",
                            note_title_error: "Titulo es invalido.",
                            note_body_error: "Contenido es invalido."
                        }
                    }
                }
            }
        };

        /**
         * @polymerBehavior Polymer.ArpaCoreModel
         */
        Polymer.ArpaCoreModel = {
            properties: {
                user: {
                    type: Object,
                    value: {},
                    notify: true
                },
                accessToken: {
                    type: String,
                    value: null,
                    notify: true
                },
                signedIn: {
                    type: Boolean,
                    value: false,
                    notify: true
                },
                online: {
                    type: Boolean,
                    value: false,
                    notify: true
                }
            }
        };

        /**
         * @polymerBehavior Polymer.ArpaForms
         */
        Polymer.ArpaForms = {
            cloneObject: function (_object) {
                return JSON.parse(JSON.stringify(_object));
            },
            toEditableObject: function (_object) {
                var clonedObj = this.cloneObject(_object);
                delete clonedObj["$id"];
                return clonedObj;
            },
            performFieldsValidation: function (_fieldIds) {
                var valid = true;
                for (var i = 0; i < _fieldIds.length; i++) {
                    this.$[_fieldIds[i]].validate();
                    if (this.$[_fieldIds[i]].invalid) {
                        valid = false;
                    }
                }
                return valid;
            },
            clearFieldsValidation: function (_fieldIds, _clearFields) {
                for (var i = 0; i < _fieldIds.length; i++) {
                    if (this.$[_fieldIds[i]]) {
                        if (_clearFields && this.$[_fieldIds[i]].clear) {
                            this.$[_fieldIds[i]].clear();
                        }
                        this.$[_fieldIds[i]].invalid = false;
                    } else {
                        console.log("Field not found: " + _fieldIds[i]);
                    }
                }
            },
            setPropertiesFromEntity: function (_objectName, _propertyNames) {
                var jsonObject = this.get(_objectName);
                for (var i = 0; i < _propertyNames.length; i++) {
                    var propertyName = _propertyNames[i];
                    var propertyValue = jsonObject[propertyName];
//                    if (typeof propertyValue !== 'undefined')
                    {
                        var propertyPath = _objectName + "." + propertyName;
                        console.log("propertyPath: ", propertyPath, "propertyValue: ", propertyValue)
                        this.set(propertyPath, propertyValue);
                    }
                }
            },
            pushPropertiesToEntity: function (_objectName, _propertyNames) {
                var jsonObject = this.get(_objectName);
                for (var i = 0; i < _propertyNames.length; i++) {
                    var propertyName = _propertyNames[i];
                    var propertyPath = _objectName + "." + propertyName;
                    var propertyValue = this.get(propertyPath);
                    if (typeof propertyValue !== 'undefined') {
                        jsonObject[propertyName] = propertyValue;
                    }
                }
            }
        };

        /**
         * @polymerBehavior Polymer.ArpaCollections
         */
        Polymer.ArpaCollections = {
            queryResultsToArrayObject: function (_queryResult) {
                var resultArray = [];
                if (_queryResult) {
                    for (var key in _queryResult) {
                        if (_queryResult.hasOwnProperty(key)) {
                            if (typeof _queryResult[key] === "object") {
                                var jsonObject = _queryResult[key];
                                jsonObject["$id"] = key;
                                resultArray.push(jsonObject);
                            }
                        }
                    }
                }
                return resultArray;
            }
        };
    })();
</script>
